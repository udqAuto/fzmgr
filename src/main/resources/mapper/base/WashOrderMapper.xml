<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.udianqu.wash.dao.WashOrderMapper" >
  <resultMap id="BaseResultMap" type="com.udianqu.wash.model.WashOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="order_no" property="orderNo" jdbcType="VARCHAR" />
    <result column="user_id" property="userId" jdbcType="INTEGER" />
    <result column="auto_id" property="autoId" jdbcType="INTEGER" />
    <result column="region_id" property="regionId" jdbcType="INTEGER" />
    <result column="org_id" property="orgId" jdbcType="INTEGER" />
    <result column="user_note" property="userNote" jdbcType="VARCHAR" />
    <result column="pay_id" property="payId" jdbcType="INTEGER" />
    <result column="order_time" property="orderTime" jdbcType="TIMESTAMP" />
    <result column="bill_time" property="billTime" jdbcType="TIMESTAMP" />
    <result column="washer_id" property="washerId" jdbcType="INTEGER" />
    <result column="state" property="state" jdbcType="INTEGER" />
    <result column="state_note" property="stateNote" jdbcType="VARCHAR" />
    <result column="accept_time" property="acceptTime" jdbcType="TIMESTAMP" />
    <result column="begin_time" property="beginTime" jdbcType="TIMESTAMP" />
    <result column="finish_time" property="finishTime" jdbcType="TIMESTAMP" />
    <result column="washer_note" property="washerNote" jdbcType="VARCHAR" />
    <result column="grade_washer" property="gradeWasher" jdbcType="TINYINT" />
    <result column="grade_user" property="gradeUser" jdbcType="TINYINT" />
    <result column="grade_user_note" property="gradeUserNote" jdbcType="VARCHAR" />
    <result column="photo_url_1" property="photoUrl1" jdbcType="VARCHAR" />
    <result column="photo_url_2" property="photoUrl2" jdbcType="VARCHAR" />
    <result column="photo_url_3" property="photoUrl3" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="BaseVMResultMap" type="com.udianqu.wash.viewmodel.WashOrderVM" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="order_no" property="orderNo" jdbcType="VARCHAR" />
    <result column="user_id" property="userId" jdbcType="INTEGER" />
    <result column="auto_id" property="autoId" jdbcType="INTEGER" />
    <result column="region_id" property="regionId" jdbcType="INTEGER" />
    <result column="org_id" property="orgId" jdbcType="INTEGER" />
    <result column="user_note" property="userNote" jdbcType="VARCHAR" />
    <result column="pay_id" property="payId" jdbcType="INTEGER" />
    <result column="order_time" property="orderTime" jdbcType="TIMESTAMP" />
    <result column="bill_time" property="billTime" jdbcType="TIMESTAMP" />
    <result column="washer_id" property="washerId" jdbcType="INTEGER" />
    <result column="state" property="state" jdbcType="INTEGER" />
    <result column="state_note" property="stateNote" jdbcType="VARCHAR" />
    <result column="accept_time" property="acceptTime" jdbcType="TIMESTAMP" />
    <result column="begin_time" property="beginTime" jdbcType="TIMESTAMP" />
    <result column="finish_time" property="finishTime" jdbcType="TIMESTAMP" />
    <result column="washer_note" property="washerNote" jdbcType="VARCHAR" />
    <result column="grade_washer" property="gradeWasher" jdbcType="TINYINT" />
    <result column="grade_user" property="gradeUser" jdbcType="TINYINT" />
    <result column="grade_user_note" property="gradeUserNote" jdbcType="VARCHAR" />
    <result column="photo_url_1" property="photoUrl1" jdbcType="VARCHAR" />
    <result column="photo_url_2" property="photoUrl2" jdbcType="VARCHAR" />
    <result column="photo_url_3" property="photoUrl3" jdbcType="VARCHAR" />
    
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="auto_pn" property="autoPN" jdbcType="VARCHAR" />
    <result column="region_name" property="regionName" jdbcType="VARCHAR" />
    <result column="shop_name" property="shopName" jdbcType="VARCHAR" />
    <result column="pay_type" property="payType" jdbcType="VARCHAR" />
    <result column="washer_name" property="washerName" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    id, order_no, user_id, auto_id, region_id, org_id, user_note, pay_id, order_time, 
    bill_time, washer_id, state, state_note, accept_time, begin_time, finish_time, washer_note, 
    grade_washer, grade_user, grade_user_note
  </sql>
  <sql id="BaseVM_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    w.id, w.order_no, w.user_id, w.auto_id, w.region_id, w.org_id, w.user_note, w.pay_id, w.order_time, 
    w.bill_time, w.washer_id, w.state, w.state_note, w.accept_time, w.begin_time, w.finish_time, w.washer_note, 
    w.grade_washer, w.grade_user,w.grade_user_note,   a.pn as auto_pn,r.name as region_name,o.name as shop_name,
    p.pay_type as pay_type,u.name as washer_name,
    (select group_concat(wtp.name) from t_wash_type wtp, t_wash_order_item wi where wi.order_id = w.id and wtp.id = wi.wash_type_id) as washTypeName
  </sql>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.udianqu.wash.model.WashOrderExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from t_wash_order
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_wash_order
    where id = #{id,jdbcType=INTEGER}
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    delete from t_wash_order
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByExample" parameterType="com.udianqu.wash.model.WashOrderExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    delete from t_wash_order
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.udianqu.wash.model.WashOrder" >
  <selectKey resultType="INTEGER" keyProperty="id">
       SELECT LAST_INSERT_ID()
  </selectKey>
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    insert into t_wash_order (id, order_no, user_id, 
      auto_id, region_id, org_id, 
      user_note, pay_id, order_time, 
      bill_time, washer_id, state, 
      state_note, accept_time, begin_time, 
      finish_time, washer_note, grade_washer, 
      grade_user)
    values (#{id,jdbcType=INTEGER}, #{orderNo,jdbcType=VARCHAR}, #{userId,jdbcType=INTEGER}, 
      #{autoId,jdbcType=INTEGER}, #{regionId,jdbcType=INTEGER}, #{orgId,jdbcType=INTEGER}, 
      #{userNote,jdbcType=VARCHAR}, #{payId,jdbcType=INTEGER}, #{orderTime,jdbcType=TIMESTAMP}, 
      #{billTime,jdbcType=TIMESTAMP}, #{washerId,jdbcType=INTEGER}, #{state,jdbcType=INTEGER}, 
      #{stateNote,jdbcType=VARCHAR}, #{acceptTime,jdbcType=TIMESTAMP}, #{beginTime,jdbcType=TIMESTAMP}, 
      #{finishTime,jdbcType=TIMESTAMP}, #{washerNote,jdbcType=VARCHAR}, #{gradeWasher,jdbcType=TINYINT}, 
      #{gradeUser,jdbcType=TINYINT})
  </insert>
  <insert id="insertSelective" parameterType="com.udianqu.wash.model.WashOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    insert into t_wash_order
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="orderNo != null" >
        order_no,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
      <if test="autoId != null" >
        auto_id,
      </if>
      <if test="regionId != null" >
        region_id,
      </if>
      <if test="orgId != null" >
        org_id,
      </if>
      <if test="userNote != null" >
        user_note,
      </if>
      <if test="payId != null" >
        pay_id,
      </if>
      <if test="orderTime != null" >
        order_time,
      </if>
      <if test="billTime != null" >
        bill_time,
      </if>
      <if test="washerId != null" >
        washer_id,
      </if>
      <if test="state != null" >
        state,
      </if>
      <if test="stateNote != null" >
        state_note,
      </if>
      <if test="acceptTime != null" >
        accept_time,
      </if>
      <if test="beginTime != null" >
        begin_time,
      </if>
      <if test="finishTime != null" >
        finish_time,
      </if>
      <if test="washerNote != null" >
        washer_note,
      </if>
      <if test="gradeWasher != null" >
        grade_washer,
      </if>
      <if test="gradeUser != null" >
        grade_user,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="orderNo != null" >
        #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=INTEGER},
      </if>
      <if test="autoId != null" >
        #{autoId,jdbcType=INTEGER},
      </if>
      <if test="regionId != null" >
        #{regionId,jdbcType=INTEGER},
      </if>
      <if test="orgId != null" >
        #{orgId,jdbcType=INTEGER},
      </if>
      <if test="userNote != null" >
        #{userNote,jdbcType=VARCHAR},
      </if>
      <if test="payId != null" >
        #{payId,jdbcType=INTEGER},
      </if>
      <if test="orderTime != null" >
        #{orderTime,jdbcType=TIMESTAMP},
      </if>
      <if test="billTime != null" >
        #{billTime,jdbcType=TIMESTAMP},
      </if>
      <if test="washerId != null" >
        #{washerId,jdbcType=INTEGER},
      </if>
      <if test="state != null" >
        #{state,jdbcType=INTEGER},
      </if>
      <if test="stateNote != null" >
        #{stateNote,jdbcType=VARCHAR},
      </if>
      <if test="acceptTime != null" >
        #{acceptTime,jdbcType=TIMESTAMP},
      </if>
      <if test="beginTime != null" >
        #{beginTime,jdbcType=TIMESTAMP},
      </if>
      <if test="finishTime != null" >
        #{finishTime,jdbcType=TIMESTAMP},
      </if>
      <if test="washerNote != null" >
        #{washerNote,jdbcType=VARCHAR},
      </if>
      <if test="gradeWasher != null" >
        #{gradeWasher,jdbcType=TINYINT},
      </if>
      <if test="gradeUser != null" >
        #{gradeUser,jdbcType=TINYINT},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.udianqu.wash.model.WashOrderExample" resultType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    select count(*) from t_wash_order
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    update t_wash_order
    <set >
      <if test="record.id != null" >
        id = #{record.id,jdbcType=INTEGER},
      </if>
      <if test="record.orderNo != null" >
        order_no = #{record.orderNo,jdbcType=VARCHAR},
      </if>
      <if test="record.userId != null" >
        user_id = #{record.userId,jdbcType=INTEGER},
      </if>
      <if test="record.autoId != null" >
        auto_id = #{record.autoId,jdbcType=INTEGER},
      </if>
      <if test="record.regionId != null" >
        region_id = #{record.regionId,jdbcType=INTEGER},
      </if>
      <if test="record.orgId != null" >
        org_id = #{record.orgId,jdbcType=INTEGER},
      </if>
      <if test="record.userNote != null" >
        user_note = #{record.userNote,jdbcType=VARCHAR},
      </if>
      <if test="record.payId != null" >
        pay_id = #{record.payId,jdbcType=INTEGER},
      </if>
      <if test="record.orderTime != null" >
        order_time = #{record.orderTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.billTime != null" >
        bill_time = #{record.billTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.washerId != null" >
        washer_id = #{record.washerId,jdbcType=INTEGER},
      </if>
      <if test="record.state != null" >
        state = #{record.state,jdbcType=INTEGER},
      </if>
      <if test="record.stateNote != null" >
        state_note = #{record.stateNote,jdbcType=VARCHAR},
      </if>
      <if test="record.acceptTime != null" >
        accept_time = #{record.acceptTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.beginTime != null" >
        begin_time = #{record.beginTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.finishTime != null" >
        finish_time = #{record.finishTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.washerNote != null" >
        washer_note = #{record.washerNote,jdbcType=VARCHAR},
      </if>
      <if test="record.gradeWasher != null" >
        grade_washer = #{record.gradeWasher,jdbcType=TINYINT},
      </if>
      <if test="record.gradeUser != null" >
        grade_user = #{record.gradeUser,jdbcType=TINYINT},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    update t_wash_order
    set id = #{record.id,jdbcType=INTEGER},
      order_no = #{record.orderNo,jdbcType=VARCHAR},
      user_id = #{record.userId,jdbcType=INTEGER},
      auto_id = #{record.autoId,jdbcType=INTEGER},
      region_id = #{record.regionId,jdbcType=INTEGER},
      org_id = #{record.orgId,jdbcType=INTEGER},
      user_note = #{record.userNote,jdbcType=VARCHAR},
      pay_id = #{record.payId,jdbcType=INTEGER},
      order_time = #{record.orderTime,jdbcType=TIMESTAMP},
      bill_time = #{record.billTime,jdbcType=TIMESTAMP},
      washer_id = #{record.washerId,jdbcType=INTEGER},
      state = #{record.state,jdbcType=INTEGER},
      state_note = #{record.stateNote,jdbcType=VARCHAR},
      accept_time = #{record.acceptTime,jdbcType=TIMESTAMP},
      begin_time = #{record.beginTime,jdbcType=TIMESTAMP},
      finish_time = #{record.finishTime,jdbcType=TIMESTAMP},
      washer_note = #{record.washerNote,jdbcType=VARCHAR},
      grade_washer = #{record.gradeWasher,jdbcType=TINYINT},
      grade_user = #{record.gradeUser,jdbcType=TINYINT}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.udianqu.wash.model.WashOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    update t_wash_order
    <set >
      <if test="orderNo != null" >
        order_no = #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="userId != null" >
        user_id = #{userId,jdbcType=INTEGER},
      </if>
      <if test="autoId != null" >
        auto_id = #{autoId,jdbcType=INTEGER},
      </if>
      <if test="regionId != null" >
        region_id = #{regionId,jdbcType=INTEGER},
      </if>
      <if test="orgId != null" >
        org_id = #{orgId,jdbcType=INTEGER},
      </if>
      <if test="userNote != null" >
        user_note = #{userNote,jdbcType=VARCHAR},
      </if>
      <if test="payId != null" >
        pay_id = #{payId,jdbcType=INTEGER},
      </if>
      <if test="orderTime != null" >
        order_time = #{orderTime,jdbcType=TIMESTAMP},
      </if>
      <if test="billTime != null" >
        bill_time = #{billTime,jdbcType=TIMESTAMP},
      </if>
      <if test="washerId != null" >
        washer_id = #{washerId,jdbcType=INTEGER},
      </if>
      <if test="state != null" >
        state = #{state,jdbcType=INTEGER},
      </if>
      <if test="stateNote != null" >
        state_note = #{stateNote,jdbcType=VARCHAR},
      </if>
      <if test="acceptTime != null" >
        accept_time = #{acceptTime,jdbcType=TIMESTAMP},
      </if>
      <if test="beginTime != null" >
        begin_time = #{beginTime,jdbcType=TIMESTAMP},
      </if>
      <if test="finishTime != null" >
        finish_time = #{finishTime,jdbcType=TIMESTAMP},
      </if>
      <if test="washerNote != null" >
        washer_note = #{washerNote,jdbcType=VARCHAR},
      </if>
      <if test="gradeWasher != null" >
        grade_washer = #{gradeWasher,jdbcType=TINYINT},
      </if>
      <if test="gradeUser != null" >
        grade_user = #{gradeUser,jdbcType=TINYINT},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.udianqu.wash.model.WashOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 20 12:31:35 CST 2015.
    -->
    update t_wash_order
    set order_no = #{orderNo,jdbcType=VARCHAR},
      user_id = #{userId,jdbcType=INTEGER},
      auto_id = #{autoId,jdbcType=INTEGER},
      region_id = #{regionId,jdbcType=INTEGER},
      org_id = #{orgId,jdbcType=INTEGER},
      user_note = #{userNote,jdbcType=VARCHAR},
      pay_id = #{payId,jdbcType=INTEGER},
      order_time = #{orderTime,jdbcType=TIMESTAMP},
      bill_time = #{billTime,jdbcType=TIMESTAMP},
      washer_id = #{washerId,jdbcType=INTEGER},
      state = #{state,jdbcType=INTEGER},
      state_note = #{stateNote,jdbcType=VARCHAR},
      accept_time = #{acceptTime,jdbcType=TIMESTAMP},
      begin_time = #{beginTime,jdbcType=TIMESTAMP},
      finish_time = #{finishTime,jdbcType=TIMESTAMP},
      washer_note = #{washerNote,jdbcType=VARCHAR},
      grade_washer = #{gradeWasher,jdbcType=TINYINT},
      grade_user = #{gradeUser,jdbcType=TINYINT}
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByOrderNo" parameterType="java.util.Map" >
    update t_wash_order
    <set>
      <if test="acceptTime != null" >
        accept_time = #{acceptTime,jdbcType=TIMESTAMP},
      </if>
      <if test="washerId != null" >
        washer_id = #{washerId,jdbcType=INTEGER},
      </if>
      <if test="washerNote != null" >
        washer_note = #{washerNote,jdbcType=VARCHAR},
      </if>
      <if test="state != null" >
        state = #{state,jdbcType=INTEGER},
      </if>
      <if test="stateNote != null" >
        state_note = #{stateNote,jdbcType=VARCHAR},
      </if>
      <if test="beginTime != null" >
        begin_time = #{beginTime,jdbcType=TIMESTAMP},
      </if>
      <if test="finishTime != null" >
        finish_time = #{finishTime,jdbcType=TIMESTAMP},
      </if>
      <if test="gradeUser != null" >
        grade_user = #{gradeUser,jdbcType=TINYINT},
      </if>
      <if test="gradeUserNote != null" >
        grade_user_note = #{gradeUserNote,jdbcType=VARCHAR},
      </if>
      <if test="photoUrl1 != null" >
        photo_url_1 = #{photoUrl1,jdbcType=VARCHAR},
      </if>
      <if test="photoUrl2 != null" >
        photo_url_2 = #{photoUrl2,jdbcType=VARCHAR},
      </if>
      <if test="photoUrl3 != null" >
        photo_url_3 = #{photoUrl3,jdbcType=VARCHAR},
      </if>
    </set>
    where order_no = #{orderNo,jdbcType=VARCHAR}
  </update>
  
  <select id="loadWashOrderCount"   parameterType="java.util.Map"  resultType="java.lang.Integer" >
	select  count(*)
	from t_wash_order o 
	     left join t_user u on o.user_id = u.id and u.user_type = 8
	     left join t_auto a on o.auto_id = a.id
	     left join t_org  org on o.org_id = org.id
	where org.path like CONCAT(#{orgPath,jdbcType=VARCHAR},'%' )
		<if test="stateIds != null ">
			and o.state in
  			<foreach item="item" index="index" collection="stateIds" open="(" separator="," close=")">  
					#{item}
			</foreach>
		</if>
		<if test="orgId != null ">
			and o.org_id = #{orgId,jdbcType=INTEGER}
		</if>
		<if test="userName != null ">
			and u.name like CONCAT('%',#{userName,jdbcType=VARCHAR},'%')
		</if>
		<if test="customerMobile != null ">
			and u.mobile like CONCAT('%',#{customerMobile,jdbcType=VARCHAR},'%')
		</if>
		<if test="autoId != null ">
			and o.auto_id =#{autoId,jdbcType=INTEGER} and o.state != 0
		</if>
		<if test="autoPN != null ">
			and a.pn like CONCAT('%',#{autoPN,jdbcType=VARCHAR},'%')
		</if>
		<if test="startTime != null ">
			and o.start_time  &gt;=#{startTime,jdbcType=TIMESTAMP}
		</if>
		<if test="endTime != null">
			and o.end_time  &lt;=#{endTime,jdbcType=TIMESTAMP}
		</if>
  </select>
  <select id="loadOrderObjById"   parameterType="java.lang.Integer"   resultType="com.udianqu.wash.viewmodel.WashOrderVM"   >
	select  o.id                as id,				 
			o.state 			as state,
			o.state_note        as stateNote, 			 
			o.order_no 			as orderNo,         
			u.name 				as customerName,  
			u.mobile  			as customerMobile,  
			r.name 				as regionName,		 
			o.user_note 		as userNote, 		 
			a.pn 				as autoPN,			 
			a.position 			as autoPosition,			 
			o.order_time 		as orderTime,		 
			o.bill_time 		as billTime, 		 
			(select f.name from t_user f where f.id = o.washer_id) as washerName,
			o.accept_time 		as acceptTime,		 
			o.begin_time 		as beginTime,		 
			o.finish_time 		as finishTime, 		 
			ct.name 			as couponName,
			(select group_concat(wtp.name) from t_wash_type wtp, t_wash_order_item wi where wi.order_id = o.id and wtp.id = wi.wash_type_id) as washTypeName,
	        (select sum(wi.coupon_amount) from t_wash_order_item wi where wi.order_id = o.id) as couponAmount,
            (select sum(wi.fixed_amount) from t_wash_order_item wi where wi.order_id = o.id) as fixedAmount,
            (select sum(wi.final_amount) from t_wash_order_item wi where wi.order_id = o.id) as finalAmount, 	 
			o.grade_washer		as washerGrade,		 
			o.grade_user		as customerGrade,
			o.grade_user_note   as gradeUserNote,
			p.pay_type          as PayType		 
	from t_wash_order o 
		left join t_user u on o.user_id = u.id and u.user_type = 8
		left join t_auto a on o.auto_id = a.id
		left join t_org  org on o.org_id = org.id
		left join t_region r on o.region_id = r.id
		left join t_wash_order_item w on o.id = w.order_id 
		left join t_wash_type wt on w.wash_type_id = wt.id
		left join t_coupon c on w.coupon_id = c.id
		left join t_coupon_type ct on c.coupon_type_id = ct.id
		left join t_pay p on p.order_id = o.id
	where 1=1 
	<if test="id != null">
		and  o.id = #{id,jdbcType=INTEGER}
	</if>
	group by o.order_no order by o.bill_time desc;
  </select>
  <select id="getOrderByMap"   parameterType="java.util.Map"  resultMap="BaseVMResultMap"  >
	select  o.id                as id,	 
			o.state 			as state,
			o.state_note        as stateNote,	 
			o.order_no 			as orderNo,
			o.user_id           as userId,       
			u.name 				as customerName,
			u.mobile  			as customerMobile,  
			r.name 				as regionName,		 
			o.user_note 		as userNote, 		 
			a.pn 				as autoPN,
			a.brand             as autoBrand,
			a.model             as autoModel,
			a.position			as autoPosition, 
			o.order_time 		as orderTime,		 
			o.bill_time 		as billTime, 		 
			(select f.name from t_user f where f.id = o.washer_id) as washerName,
			o.accept_time 		as acceptTime,		 
			o.begin_time 		as beginTime,		 
			o.finish_time 		as finishTime, 		 
			ct.name 			as couponName,
            (select group_concat(wtp.name) from t_wash_type wtp, t_wash_order_item wi where wi.order_id = o.id and wtp.id = wi.wash_type_id) as washTypeName,
	        (select sum(wi.coupon_amount) from t_wash_order_item wi where wi.order_id = o.id) as couponAmount,
            (select sum(wi.fixed_amount) from t_wash_order_item wi where wi.order_id = o.id) as fixedAmount,
            (select sum(wi.final_amount) from t_wash_order_item wi where wi.order_id = o.id) as finalAmount,
			o.grade_washer		as washerGrade,		 
			o.grade_user		as customerGrade,
			o.grade_user_note   as gradeUserNote,
			o.photo_url_1       as photoUrl1,		 
			o.photo_url_2       as photoUrl2,		 
			o.photo_url_3       as photoUrl3,
			p.pay_type          as payType	 
	from t_wash_order o
		left join t_user u on o.user_id = u.id and u.user_type = 8
		left join t_auto a on o.auto_id = a.id
		left join t_org  org on o.org_id = org.id
		left join t_region r on o.region_id = r.id
		left join t_wash_order_item w on o.id = w.order_id 
		left join t_wash_type wt on w.wash_type_id = wt.id
		left join t_coupon c on w.coupon_id = c.id
		left join t_coupon_type ct on c.coupon_type_id = ct.id
		left join t_pay p on p.order_id = o.id
    where 1=1
	<if test="state != null">
		and o.state = #{state,jdbcType=INTEGER} 
	</if>
	<if test="states != null ">
		and o.state in
  		<foreach item="item" index="index" collection="states" open="(" separator="," close=")">  
				#{item}
		</foreach>
	</if>
	<if test="washerId != null">
		and o.washer_id = #{washerId,jdbcType=INTEGER} 
	</if>
	<if test="orgId != null">
		and o.org_id = #{orgId,jdbcType=INTEGER} 
	</if>
	group by o.order_no  order by o.bill_time desc;
  </select>
  <select id="getOrderByUserId"  parameterType="java.lang.Integer" resultMap="BaseVMResultMap">
	select  o.id                as id,	 
			o.state 			as state,
			o.state_note        as stateNote,	 
			o.order_no 			as orderNo,         
			u.name 				as customerName,
			u.mobile  			as customerMobile,  
			r.name 				as regionName,		 
			o.user_note 		as userNote, 		 
			a.pn 				as autoPN,			 
			o.order_time 		as orderTime,		 
			o.bill_time 		as billTime, 		 
			(select f.name from t_user f where f.id = o.washer_id) as washerName,
			o.accept_time 		as acceptTime,		 
			o.begin_time 		as beginTime,		 
			o.finish_time 		as finishTime, 		 
			ct.name 			as couponName,
            (select group_concat(wtp.name) from t_wash_type wtp, t_wash_order_item wi where wi.order_id = o.id and wtp.id = wi.wash_type_id) as washTypeName,
	        (select sum(wi.coupon_amount) from t_wash_order_item wi where wi.order_id = o.id) as couponAmount,
            (select sum(wi.fixed_amount) from t_wash_order_item wi where wi.order_id = o.id) as fixedAmount,
            (select sum(wi.final_amount) from t_wash_order_item wi where wi.order_id = o.id) as finalAmount,
			o.grade_washer		as washerGrade,		 
			o.grade_user		as customerGrade,
			o.grade_user_note   as gradeUserNote,
			o.photo_url_1       as photoUrl1,		 
			o.photo_url_2       as photoUrl2,		 
			o.photo_url_3       as photoUrl3,
			p.pay_type          as payType		 
	from t_wash_order o
		left join t_user u on o.user_id = u.id and u.user_type = 8
		left join t_auto a on o.auto_id = a.id
		left join t_org  org on o.org_id = org.id
		left join t_region r on o.region_id = r.id
		left join t_wash_order_item w on o.id = w.order_id 
		left join t_wash_type wt on w.wash_type_id = wt.id
		left join t_coupon c on w.coupon_id = c.id
		left join t_coupon_type ct on c.coupon_type_id = ct.id
		left join t_pay p on p.order_id = o.id
	where o.state != 0 and o.bill_time between #{startDate,jdbcType=TIMESTAMP} and #{endDate,jdbcType=TIMESTAMP}
	<if test="userId != null">
		and o.user_id = #{userId,jdbcType=INTEGER}
	</if>
	group by o.order_no  order by o.bill_time desc;
  </select>
  <select id="loadWashOrderlistWithPage"   parameterType="java.util.Map"   resultType="com.udianqu.wash.viewmodel.WashOrderVM"   >
	select  o.id                as id,
			o.state 			as state, 
			o.state_note        as stateNote,
			o.order_no 			as orderNo, 
			u.name 				as customerName, 
			u.mobile 			as customerMobile, 
			o.grade_user		as customerGrade, 
			o.user_note 		as userNote, 
			a.pn 				as autoPN,
			a.position 			as autoPosition,
			(select group_concat(wtp.name) from t_wash_type wtp, t_wash_order_item wi where wi.order_id = o.id and wtp.id = wi.wash_type_id) as washTypeName,
			o.order_time 		as orderTime,
			o.bill_time 		as billTime, 
			o.accept_time 		as acceptTime,
			o.begin_time 		as beginTime,
			o.finish_time 		as finishTime,
			p.amount            as finalAmount,
			p.pay_type          as payType
	from t_wash_order o 
		left join t_user u on o.user_id = u.id and u.user_type = 8
		left join t_auto a on o.auto_id = a.id
		left join t_org  org on o.org_id = org.id
		left join t_pay p on p.order_id = o.id
		left join t_wash_order_item w on o.id = w.order_id 
		left join t_wash_type wt on w.wash_type_id = wt.id
	where org.path like CONCAT(#{orgPath,jdbcType=VARCHAR},'%' )
		<if test="stateIds != null ">
			and o.state in
  			<foreach item="item" index="index" collection="stateIds" open="(" separator="," close=")">  
					#{item}
			</foreach>
		</if>
		<if test="orgId != null ">
			and o.org_id = #{orgId,jdbcType=INTEGER}
		</if>
		<if test="userName != null ">
			and u.name like CONCAT('%',#{userName,jdbcType=VARCHAR},'%')
		</if>
		<if test="customerMobile != null ">
			and u.mobile like CONCAT('%',#{customerMobile,jdbcType=VARCHAR},'%')
		</if>
		<if test="autoId != null ">
			and o.auto_id =#{autoId,jdbcType=INTEGER} and o.state != 0
		</if>
		<if test="autoPN != null ">
			and a.pn like CONCAT('%',#{autoPN,jdbcType=VARCHAR},'%')
		</if>
		<if test="washTypeName != null ">
			and wt.name like CONCAT('%',#{washTypeName,jdbcType=VARCHAR},'%')
		</if>
		<if test="startTime != null ">
			and o.bill_time  &gt;=#{startTime,jdbcType=TIMESTAMP}
		</if>
		<if test="endTime != null">
			and o.end_time  &lt;=#{endTime,jdbcType=TIMESTAMP}
		</if>
		group by o.order_no order by o.bill_time desc
  		<if test="pageStart !=null">
  		limit #{pageStart,jdbcType=INTEGER}, #{pageSize,jdbcType=INTEGER}
  		</if>
  </select>
  
  <select id="loadReportlist"   parameterType="java.util.Map"  resultType="com.udianqu.wash.viewmodel.ReportVM"  >
  		  

	select 0 as category,shopName ,'已下单' as displayName ,count(xd.orderId) as qty,0 as Amount  from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where 1=1 
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	)as xd where xd.orderStatus = 1 GROUP BY xd.shopName
	union
	select 1 as category,shopName ,'已接单' as displayName ,count(jd.orderId) as qty,0 as Amount  from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) as jd  where jd.orderStatus in(2,3) GROUP BY jd.shopName
	union 
	select 2 as category,shopName ,'已完成' as displayName ,count(wc.orderId) as qty,0 as Amount  from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) as wc  where wc.orderStatus = 4 GROUP BY wc.shopName
	union
	select 3 as category,shopName ,'已评价' as displayName ,count(pj.orderId) as qty,0 as Amount  from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) as pj where pj.orderStatus = 5 GROUP BY pj.shopName
	union 
	select 4 as category,shopName ,'总数' as displayName ,count(tt.orderId) as qty ,0 as Amount from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) tt where tt.orderStatus != 0 GROUP BY tt.shopName
	union
	select 5 as category,shopName ,'快洗' as displayName ,count(kx.orderId) as qty,0 as Amount  from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) kx where kx.washType = '快洗' GROUP BY kx.shopName
	union
	select 6 as category,shopName ,'内堂' as displayName ,count(nt.orderId) as qty,0 as Amount  from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) nt where nt.washType = '内堂' GROUP BY nt.shopName
	union 
	select 7 as category,shopName ,'打蜡' as displayName ,count(dl.orderId) as qty ,0 as Amount from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) as dl where dl.washType = '打蜡' GROUP BY dl.shopName
	union
	select 8 as category,shopName ,'支付宝' as displayName ,count(zfb.orderId) as qty ,0 as Amount from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) as zfb where zfb.payType = '支付宝'  GROUP BY zfb.shopName
	union
	select 9 as category,shopName ,'微信' as displayName ,count(wx.orderId) as qty ,0 as Amount from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) as wx where wx.payType = '微信' GROUP BY wx.shopName
	union
	select 10 as category,shopName ,'余额支付' as displayName ,count(ye.orderId) as qty,0 as Amount from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) as ye where ye.payType = '余额支付' GROUP BY ye.shopName
	union
	select 11 as category,shopName ,'总金额' as displayName , 0 as qty,sum(tm.washAmount) as Amount from  (
		select
			wo.id					as orderId,
			o.name				as shopName,
			wo.state 			as orderStatus,
			CASE p.pay_type	
						when 1 THEN '支付宝' 
						when 2 THEN '微信'  
						when 100 THEN '余额支付'	END as payType,
			wt.`name` 		as washType,
			p.amount			as washAmount
		from 
			t_wash_order as wo
		left join t_org as o  on  wo.org_id =o.id
		left join t_wash_order_item as woi on wo.id = woi.order_id
		left join t_wash_type as wt on woi.wash_type_id = wt.id
		left join t_pay as p on wo.id = p.order_id
		where
			 1=1  
		<if test="startTime != null ">
			and wo.bill_time between {#startTime,jdbcType=TIMESPAN} and {#endTime,jdbcType=TIMESPAN}
		</if> 
		<if test="date != null ">
			and wo.bill_time like CONCAT(#{date,jdbcType=TIMESPAN},'%' )
		</if> 
	) as tm where tm.orderStatus != 0 GROUP BY tm.shopName

  </select>
  
  <select id="selectByOrderNo" resultMap="BaseVMResultMap" parameterType="java.lang.String" >
    select 
    <include refid="BaseVM_Column_List" />
    from t_wash_order w
        left join t_user u on w.washer_id = u.id
		left join t_auto a on w.auto_id = a.id
		left join t_org  o on w.org_id = o.id
		left join t_region r on w.region_id = r.id
		left join t_pay p on p.order_id = w.id
    where w.order_no = #{orderNo,jdbcType=VARCHAR}
  </select>
</mapper>